# MERN_app_template

# Содержание
1. [Конфигурация](#Конфигурация)
    1. [Поля конфига](#Поля_конфига)
2. [Запуск приложения](#Запуск_приложения)
3. [База данных](#База_данных)
4. [API](#API)
5. [Система логирования](#Система_логирования)
6. [Хранение пользовательских файлов](#Хранение_пользовательских_файлов)
7. [Swagger](#Swagger)
8. [Отправка сообщений Email](#Отправка_сообщений_Email)
9. [Система авторизации](#Система_авторизации)
    1. [Роли](#Роли)
    2. [Создание пользователей](#Создание_пользователей)


# Конфигурация <a name="Конфигурация"></a>
Сделайте копию папки *./config.example*  и переменуйте в *config* 

*default.json* - конфиг для разработки
*production.json* - конфиг для продакшена 

## Поля конфига <a name="Поля_конфига"></a>
*port* - Порт запуска приложения  
*url_main_page* - Url главной страницы  
*mongoUrl* - Ссылка подключения к MongoDB [База данных](#База_данных)  
*emailSendMessage* - Логин аккаунта для отправки сообщения [Отправка сообщений Email](#Отправка_сообщений_Email)  
*passSendMessage* - Пароль аккаунта для отправки сообщения [Отправка сообщений Email](#Отправка_сообщений_Email)  
*secret_key* - Секретный ключ приложения, сгенерировать любой, симвалов 30 хватит   
*start_users* - Создание пользователей через конфиг [Создание пользователей](#Создание_пользователей)
*logger_console* - Boolean, писать логи в консоль [Система логирования](#Система_логирования)
*logger_file* - Boolean, писать логи в файл [Система логирования](#Система_логирования)
*logger_mongoDB* - Boolean, писать логи в Базу данных [Система логирования](#Система_логирования)

# Запуск приложения <a name="Запуск_приложения"></a>
Установка зависимостей для сервера
```
npm install
```
Установка зависимостей клиентской части
```
npm run client:install
```
# База данных <a name="База_данных"></a>
База данных MongoDB  
Для подключения БД нужно указать ссылка на подключение в поле *mongoUrl* в файле конфигурации [Поля конфига](#Поля_конфига)
# API <a name="API"></a>

# Система логирования <a name="Система_логирования"></a>
Система логирования *winston*  
[Статья поможет если, что переписать система логирования](https://www.8host.com/blog/logirovanie-prilozheniya-node-js-s-pomoshhyu-winston/)
## Настройка логера 
В файле конфигурации заполняем полья *logger_console*, *logger_file*, *logger_mongoDB* для определения места записи логов [Поля конфига](#Поля_конфига)

## Использование логера 
Импортируем объект логера из файла *./modules/logger.js*

```
import logger from "./modules/logger.js";
```

>Уровни логирования определяют приоритет сообщения и обозначаются целым числом. Winston использует уровни логирования npm, где 0 имеет наивысший приоритет.
> 0: error (ошибка)  
> 1: warn (предупреждение)  
> 2: info (информация)  
> 3: verbose (расширенный вывод)  
> 4: debug (отладочное сообщение)  
> 5: silly (простое сообщение)  

Создание лога:
```
logger.info('INFO') // Информационный лог
logger.error('ERROR') // Лог об ошибки
...
```
# Хранение пользовательских файлов <a name="Хранение_пользовательских_файлов"></a>
# Swagger <a name="Swagger"></a>
# Отправка сообщений Email <a name="Отправка_сообщений_Email"></a>
# Система авторизации <a name="Система_авторизации"></a>
## Роли <a name="Роли"></a>

Изначально надо создать роли пользователей в файле **./role_list.js**  

Пример:
```
export const USER = "USER";
export const ADMIN = "ADMIN";

export const ALL_ROLES = [
    USER,
    ADMIN
];
```
И запустить скрипт 
```
npm run create:roles
```

## Создание пользователей <a name="Создание_пользователей"></a>

Для создания пользователей можно использовать поле *start_users* в файле конфигурации  

Пример:
```
"start_users": [
    {
      "login": "admin",
      "pass": "123123",
      "roles": ["ADMIN"]
    }
]
```
И запустить скрипт 
```
npm run create:users
```

